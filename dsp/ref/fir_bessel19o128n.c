/**************************************************************
WinFilter version 0.8
http://www.winfilter.20m.com
akundert@hotmail.com

Filter type: Low Pass
Filter model: Bessel
Filter order: 19
Sampling Frequency: 10 KHz
Cut Frequency: 2.500000 KHz
Coefficents Quantization: float

Z domain Zeros
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000

Z domain Poles
z = -0.006900 + j -0.440645
z = -0.006900 + j 0.440645
z = 0.013892 + j -0.359292
z = 0.013892 + j 0.359292
z = -0.035814 + j -0.535125
z = -0.035814 + j 0.535125
z = 0.037091 + j -0.263680
z = 0.037091 + j 0.263680
z = 0.017752 + j -0.233862
z = 0.017752 + j 0.233862
z = -0.080387 + j -0.643805
z = -0.080387 + j 0.643805
z = -0.014147 + j -0.079961
z = -0.014147 + j 0.079961
z = 0.087273 + j -0.132590
z = 0.087273 + j 0.132590
z = -0.155977 + j -0.778402
z = -0.155977 + j 0.778402
z = 0.102781 + j -0.000000
***************************************************************/
#define Ntap 128

float fir(float NewSample) {
    float FIRCoef[Ntap] = { 
        0.00000000001673567411,
        0.00000000026731115275,
        -0.00000000016391017132,
        -0.00000000035765237323,
        0.00000000045287959617,
        0.00000000035899405615,
        -0.00000000093010854660,
        -0.00000000011721258187,
        0.00000000159317868100,
        -0.00000000062052863996,
        -0.00000000230840255274,
        0.00000000220241191367,
        0.00000000267663442201,
        -0.00000000499740324027,
        -0.00000000185019626208,
        0.00000000917789396113,
        -0.00000000165739943737,
        -0.00000001426254010377,
        0.00000001004978242050,
        0.00000001832004892542,
        -0.00000002596506267660,
        -0.00000001679826994942,
        0.00000005139954560544,
        0.00000000114441797165,
        -0.00000008520308816436,
        0.00000004217439877241,
        0.00000011840383366590,
        -0.00000013083796471571,
        -0.00000012686134358821,
        0.00000028138013261462,
        0.00000006181242015729,
        -0.00000049524531130345,
        0.00000015847056381626,
        0.00000073075731246227,
        -0.00000064739862959544,
        -0.00000085623404115485,
        0.00000152166481512946,
        0.00000058554589627562,
        -0.00000281530572697979,
        0.00000058452886861249,
        0.00000429164023321171,
        -0.00000337430696427884,
        -0.00000510332149912031,
        0.00000851409376785650,
        0.00000328250515384944,
        -0.00001602917713134502,
        0.00000481824551764423,
        0.00002342883134541737,
        -0.00002458500066066489,
        -0.00002163502877811159,
        0.00006086342180641156,
        -0.00001398971037493969,
        -0.00010709931253855492,
        0.00014554372674947916,
        0.00010091357285430745,
        -0.00054380029111085102,
        0.00028036636900570635,
        0.00186795780548728140,
        -0.00279632569736350390,
        -0.00907006448746044800,
        0.01805612111570426000,
        0.11091607644181423000,
        0.23442423754652214000,
        0.29341327163627923000,
        0.23442423754652214000,
        0.11091607644181423000,
        0.01805612111570426000,
        -0.00907006448746044800,
        -0.00279632569736350390,
        0.00186795780548728140,
        0.00028036636900570635,
        -0.00054380029111085102,
        0.00010091357285430745,
        0.00014554372674947916,
        -0.00010709931253855492,
        -0.00001398971037493969,
        0.00006086342180641156,
        -0.00002163502877811159,
        -0.00002458500066066489,
        0.00002342883134541737,
        0.00000481824551764423,
        -0.00001602917713134502,
        0.00000328250515384944,
        0.00000851409376785650,
        -0.00000510332149912031,
        -0.00000337430696427884,
        0.00000429164023321171,
        0.00000058452886861249,
        -0.00000281530572697979,
        0.00000058554589627562,
        0.00000152166481512946,
        -0.00000085623404115485,
        -0.00000064739862959544,
        0.00000073075731246227,
        0.00000015847056381626,
        -0.00000049524531130345,
        0.00000006181242015729,
        0.00000028138013261462,
        -0.00000012686134358821,
        -0.00000013083796471571,
        0.00000011840383366590,
        0.00000004217439877241,
        -0.00000008520308816436,
        0.00000000114441797165,
        0.00000005139954560544,
        -0.00000001679826994942,
        -0.00000002596506267660,
        0.00000001832004892542,
        0.00000001004978242050,
        -0.00000001426254010377,
        -0.00000000165739943737,
        0.00000000917789396113,
        -0.00000000185019626208,
        -0.00000000499740324027,
        0.00000000267663442201,
        0.00000000220241191367,
        -0.00000000230840255274,
        -0.00000000062052863996,
        0.00000000159317868100,
        -0.00000000011721258187,
        -0.00000000093010854660,
        0.00000000035899405615,
        0.00000000045287959617,
        -0.00000000035765237323,
        -0.00000000016391017132,
        0.00000000026731115275,
        0.00000000001673567411,
        -0.00000000016700698219
    };

    static float x[Ntap]; //input samples
    float y=0;            //output sample
    int n;

    //shift the old samples
    for(n=Ntap-1; n>0; n--)
       x[n] = x[n-1];

    //Calculate the new output
    x[0] = NewSample;
    for(n=0; n<Ntap; n++)
        y += FIRCoef[n] * x[n];
    
    return y;
}

/**************************************************************
WinFilter version 0.8
http://www.winfilter.20m.com
akundert@hotmail.com

Filter type: Low Pass
Filter model: Bessel
Filter order: 8
Sampling Frequency: 10 KHz
Cut Frequency: 1.000000 KHz
Coefficents Quantization: float

Z domain Zeros
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000

Z domain Poles
z = 0.549992 + j -0.168189
z = 0.549992 + j 0.168189
z = 0.541783 + j -0.054615
z = 0.541783 + j 0.054615
z = 0.568193 + j -0.297450
z = 0.568193 + j 0.297450
z = 0.602076 + j -0.468146
z = 0.602076 + j 0.468146
***************************************************************/
#define Ntap 64

float fir(float NewSample) {
    float FIRCoef[Ntap] = { 
        0.00000322758967755878,
        0.00000255094392844917,
        -0.00000038450889816630,
        -0.00000535529503633269,
        -0.00001057667172256696,
        -0.00001269372080731839,
        -0.00000784419768948139,
        0.00000608443064492137,
        0.00002661035667866517,
        0.00004473340638664404,
        0.00004602873795414226,
        0.00001646027926509118,
        -0.00004731250470734587,
        -0.00012676701696600593,
        -0.00017686818314703739,
        -0.00013704021093004307,
        0.00003646427722773241,
        0.00032160582613616483,
        0.00058685301972042150,
        0.00059218301766684556,
        0.00008104073922052223,
        -0.00100858542085568690,
        -0.00223862481660449390,
        -0.00237852703123381030,
        0.00068171397051027601,
        0.00958872206074873680,
        0.02661602465149558200,
        0.05230237055363387600,
        0.08413918651807869600,
        0.11616123756943669000,
        0.14026463001665496000,
        0.14926332224127661000,
        0.14026463001665496000,
        0.11616123756943669000,
        0.08413918651807869600,
        0.05230237055363387600,
        0.02661602465149558200,
        0.00958872206074873680,
        0.00068171397051027601,
        -0.00237852703123381030,
        -0.00223862481660449390,
        -0.00100858542085568690,
        0.00008104073922052223,
        0.00059218301766684556,
        0.00058685301972042150,
        0.00032160582613616483,
        0.00003646427722773241,
        -0.00013704021093004307,
        -0.00017686818314703739,
        -0.00012676701696600593,
        -0.00004731250470734587,
        0.00001646027926509118,
        0.00004602873795414226,
        0.00004473340638664404,
        0.00002661035667866517,
        0.00000608443064492137,
        -0.00000784419768948139,
        -0.00001269372080731839,
        -0.00001057667172256696,
        -0.00000535529503633269,
        -0.00000038450889816630,
        0.00000255094392844917,
        0.00000322758967755878,
        0.00000238098578770831
    };

    static float x[Ntap]; //input samples
    float y=0;            //output sample
    int n;

    //shift the old samples
    for(n=Ntap-1; n>0; n--)
       x[n] = x[n-1];

    //Calculate the new output
    x[0] = NewSample;
    for(n=0; n<Ntap; n++)
        y += FIRCoef[n] * x[n];
    
    return y;
}

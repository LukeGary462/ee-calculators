/**************************************************************
WinFilter version 0.8
http://www.winfilter.20m.com
akundert@hotmail.com

Filter type: Low Pass
Filter model: Chebyshev
Filter order: 4
Sampling Frequency: 10 KHz
Cut Frequency: 0.010000 KHz
Pass band Ripple: 1.000000 dB
Coefficents Quantization: float

Z domain Zeros
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000
z = -1.000000 + j 0.000000

Z domain Poles
z = 0.997427 + j -0.002483
z = 0.997427 + j 0.002483
z = 0.999560 + j -0.006324
z = 0.999560 + j 0.006324
***************************************************************/
#define Ntap 64

float fir(float NewSample) {
    float FIRCoef[Ntap] = { 
        0.01054456502449359000,
        0.01074449503778397200,
        0.01094896172501740200,
        0.01115829311108945300,
        0.01137285606950880900,
        0.01159306225716571200,
        0.01181937521672235900,
        0.01205231893321171000,
        0.01229248821691418400,
        0.01254056140047633800,
        0.01279731599727789100,
        0.01306364818923833200,
        0.01334059732418397600,
        0.01362937704984362000,
        0.01393141536291451000,
        0.01424840681893503400,
        0.01458238161556854100,
        0.01493579853830432000,
        0.01531167238357861200,
        0.01571375242165272100,
        0.01614677854748309400,
        0.01661685954031445800,
        0.01713205059500099900,
        0.01770327085305397800,
        0.01834583304117673500,
        0.01908215042771231300,
        0.01994690579626550600,
        0.02099796585252881500,
        0.02234289208918381600,
        0.02421848453489223300,
        0.02733551010440367000,
        0.03667103432932653600,
        0.02733551010440367000,
        0.02421848453489223300,
        0.02234289208918381600,
        0.02099796585252881500,
        0.01994690579626550600,
        0.01908215042771231300,
        0.01834583304117673500,
        0.01770327085305397800,
        0.01713205059500099900,
        0.01661685954031445800,
        0.01614677854748309400,
        0.01571375242165272100,
        0.01531167238357861200,
        0.01493579853830432000,
        0.01458238161556854100,
        0.01424840681893503400,
        0.01393141536291451000,
        0.01362937704984362000,
        0.01334059732418397600,
        0.01306364818923833200,
        0.01279731599727789100,
        0.01254056140047633800,
        0.01229248821691418400,
        0.01205231893321171000,
        0.01181937521672235900,
        0.01159306225716571200,
        0.01137285606950880900,
        0.01115829311108945300,
        0.01094896172501740200,
        0.01074449503778397200,
        0.01054456502449359000,
        0.01034887751888014000
    };

    static float x[Ntap]; //input samples
    float y=0;            //output sample
    int n;

    //shift the old samples
    for(n=Ntap-1; n>0; n--)
       x[n] = x[n-1];

    //Calculate the new output
    x[0] = NewSample;
    for(n=0; n<Ntap; n++)
        y += FIRCoef[n] * x[n];
    
    return y;
}
